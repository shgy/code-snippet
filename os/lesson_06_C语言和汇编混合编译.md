在lesson_05的实现中,为了简化问题, 直接在kernel.c中嵌入了汇编代码.这只是为了演示功能, 简单粗暴.
为了更灵活地实现打印的功能, 本节将对代码进行改造:
1. 添加保护模式的栈段: 前面只有平坦模式的代码段和数据段, 是因为都没有用到栈.
参考<x86汇编语言-从实模式到保护模式>一书, 使用0x7a00~0x7c00共512字节的空间.
```
; 定义GDT
gdt_items  dd 0x00000000,0x00000000 ; 空GDT
           dd 0x0000ffff,0x00cf9800 ; 代码段 0x0000 4G
           dd 0x0000ffff,0x00cf9200 ; 数据段 0x0000 4G
           dd 0x00007a00,0x00409600 ; 栈段
```
使用如下的代码初始化栈:
```
    ; 初始化栈段
    mov cx,0x18 ;
    mov ss,cx
    mov esp,0x7c00
    mov ebp,esp
```
使用如下的代码测试栈的使用, 要用到`print-stack`指令
```
; test push
mov ax, 1
push ax
pop bx
```
2. 使用汇编和C混合, 实现字符的打印功能.