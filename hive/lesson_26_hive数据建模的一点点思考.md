hive的数据建模,  比较难的地方在于表结构的构造. 因为表结构构建好了过后, 再修改就比较麻烦(改结构, 补充历史数据, 修改SQL代码, 提交到流程),  而业务方的变动又会比较频繁.
如果整个建模, 链条比较长: 事实表 --> 用户层维度表  -->  日维度表  --> 结果表, 那么需要修改的地方就太多了.

以保险业务为例: 每个险种一个字段. 如果新添加了险种, 一般需要添加两个字段.  链条一长, 这个维护起来工作量就大了. 业务方想的是我就添加了一个险种而已, 而背后却需要那么多工作.

这里就引申出来了两个经验点: 
1. 尽量懒操作.  不要别出心栽地一股脑把常用的, 不常用的, 可能会用的都添加进来. 徒增维护成本.

2. 对于可能会增加的字段: 险种, 渠道 这些. 要么 按险种, 渠道增加一个维度, 要么使用`map/ struct/ named_struct/ array / create_union` 这些复杂的数据类型.
千万不能过早地针对每个险种, 设置一个字段. 这种操作, 维护成本太高了.

问题:
` map/ named_struct` 有啥区别 ? map 不能使用 max等聚合函数
这个需要看源码...  


